<!DOCTYPE html>
<html lang="en">
  <head>
    <title> Impact Schools </title>

    <!-- Google fonts code -->
    <link href="https://fonts.googleapis.com/css?family=Amiko|Roboto|Montserrat|Padauk:400,700" rel="stylesheet">

    <!-- bootstrap set up-->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- ensures website has a 1:1 ratio with the viewport (screen size) -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Stylesheet link -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/site-specific.css">

    <!-- leaflet -->
    <script src="https://unpkg.com/leaflet@1.0.1/dist/leaflet.js"></script>

    <!-- Main tangram library -->
    <script src="https://unpkg.com/tangram/dist/tangram.min.js"></script>

    <!-- favicon - img for browser -->
    <!-- <link rel="shortcut icon" type="image/png" href="img/logo.png"/> -->
  </head>

  <body>
    <div class="bodyPanel">
      <div class = "container" >
        <div class="row">

          <!-- <div class="col-md-12"> -->

            <div class="bar1" id ="title">
              <h1> Impact Schools </h1>
              <h2> Has increased police presence in public and charter schools reduced school crime, and has this facilitated the school-to-prison pipeline? </h2>
            </div>

            <div class = "bar2" id = "content">
              <p> 
                Impact schools were introduced by Mayor Bloomberg's administration as a school safety initiative with three ways to combat crime: 
                    <strong> "dispatching large numbers of uniformed police officers into targeted areas, cracking down on even minor incidents of disorderly behavior, and quickly punishing those who repeatedly violate the rules." </strong>
                NYPD officers who can handcuff and arrest suspects, including students, are stationed in New York City public and charter schools. What started off as 12 schools at the program's inception in January 2004 has since grown to include 50 schools across New York City. 
                <br>
                <br>
                While Impact Schools only make up <strong> 3% of New York City's public and charter schools </strong> , they are not equally distributed across all 5 boroughs. Queens has 34% of all impact schools, but these make up only 5% of all public and charter schools in Queens. Staten Island, on the other hand, has only 12% of impact schools but these make up 8% of its public and charter schools. The Bronx, Brooklyn and Manhattan's impact schools make up 1%, 2% and 3% of their public and charter schools respectively. 
              </p>
              <br>
              <br>
              <div id="chart1"></div>
            </div>

            <div class = "bar3" id = "content">
              <div id = "districtMap"> </div>

              <div id="leafletmap"></div>
              <div id='map'></div>

              <p class="caption"> Racial distribution of </p>
              <p> how were these impact schools selected and why? look at school attendance & crime here </p>
              <p> but race complicates this - school districts + race </p>
            
            </div>

            <div class = "bar4" id = "content">
              <p> what is the racial distribution of young people in nyc (just chart) & does this correlate with the number of young people in juvenile system? </p>
              <p> Then looking at the impact schools themselves, has crime reduced or no? what is the racial distribution of people arrested for crime? </p>
            </div>

          <!-- </div> -->

        </div>
      </div>
    </div>

  </body>

  <style type="text/css">
    /*css styling here */

    /* Make the chart container fill the page using CSS. */
    #chart {
      position: fixed;
      left: 0px;
      right: 0px;
      top: 0px;
      bottom: 0px;
    }

    /*for map*/
    body {
      margin: 0px;
      border: 0px;
      padding: 0px;
    }

    #map {
        height: 10%;
        width: 10%;
        position: absolute;
    }

  </style>


  <script src="http://d3js.org/d3.v4.min.js"></script>
  <script type="text/javascript">

    importCharts()

    function importCharts () {
        d3.xml("svg/impactSchool_distribution.svg").mimeType("image/svg+xml").get(function(error, xml) {
          var importedNode = document.importNode(xml.documentElement, true);
          d3.select("div#chart1")
            .each(function() {
              this.appendChild(importedNode);
            })
          // animateChart()
        });
    }

    // LEAFLET/MAPZEN MAP 
    var map = L.map('map'
      // , {
      //   "keyboardZoomOffset" : 1.,
      //   "minZoom" : 10,
      //   "maxZoom" : 16,
      //   "zoomControl" : true,
      //   "zoomSnap" : 0.5,
      //   "zoomDelta" : 1,
      //   "wheelPxPerZoomLevel" : 1
      // }
    );

    var layer = Tangram.leafletLayer({
        scene: '../scenes/insetMap.yaml',
    });

    layer.addTo(map);
    map.setView([40.7666561, -73.9036319], 10.5); //coordinates, scale

      function onMapHover(selection) {
        document.getElementById('map').style.cursor = selection.feature ? 'pointer' : '';
      }
      
      // ADD TANGRAMLOADED LISTENER
      var scene;
      map.on('tangramloaded', function(e) {
        var tangramLayer = e.tangramLayer;
        scene = tangramLayer.scene;

        tangramLayer.setSelectionEvents({
          click: onMapClick,
          hover: onMapHover
        });

      });

// ADD SELECTION EVENTS
      function onMapClick(selection) {
        if (selection.feature) {
          var latlng = selection.leaflet_event.latlng;
          var label = selection.feature.properties.GLG_SYM;
          showPopup(latlng, label);
        }
      }

      function showPopup(latlng, label) {
        popup
          .setLatLng(latlng)
          .setContent('<p>' + label + '</p>')
          .openOn(map);        
      }

    // function animateChart () {
    //   when MN is hovered, make the rest v transparent & then show text - x public schools and y impact 
    // }

  </script>